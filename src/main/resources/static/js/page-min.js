function openGoogle(){url="https://www.google.com/search?q="+$("#b-word").val(),window.open(url)}function openBaidu(){url="https://www.dogedoge.com/results?q="+$("#b-word").val(),window.open(url)}$(document).ready(function(){function j(){c={website_id:"0",website_name:"",website_link:"",website_sibling_name:[],website_sibling_id:[]}}function k(){$("a.website").after("<span class='edit-website'>编辑</span>")}function l(){$("a.block-name").after("<input class='edit-category' />")}function m(){$("input#website-hotkey").tagsinput()}function o(){i=!1}function q(){var c,a="",b="";for(c=0;c<f.length;c++)b=f[c],a+='<li class="website-category"><span>'+b+"</span></li>";$("div.website-grid ul.website-categories").children("li").remove(),$("div.website-grid ul.website-categories").append(a),$("div.website-grid ul.website-categories li").each(function(){"常用"==$(this).children("span").text()&&$(this).addClass("selected")}),$("div.website-grid li.website-category").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")})}function r(){jQuery.isEmptyObject(e)&&G()}function s(a){v(a.message,2e3)}function t(){$(this).css("display","none"),$("ul.navbar-right a").css("display","none"),$("a.website").css("z-index","1"),$("a.website").off("mouseenter mouseleave"),$("a.website").css("cursor","default"),$("a.website").on("click",function(a){a.preventDefault()}),$("span.edit-website").css("z-index","10"),$("span.edit-website").css("display","inherit"),$("a#finish-customize").css("display","inherit"),$("div#customize-mode-tips").css("display","inherit");var a=($(window).width()-$("div#customize-mode-tips").outerWidth())/2;$("div#customize-mode-tips").css("left",a),jQuery.isEmptyObject(e)&&G(),w()}function u(){var a="str";try{return localStorage=window.localStorage,localStorage.setItem(a,a),localStorage.removeItem(a),!0}catch(b){return!1}}function v(a,b){b=isNaN(b)?3e3:b;var c=document.createElement("div");c.innerHTML=a,c.style.cssText="width:20%; min-width:150px; background:#1db0b8; height:40px; color:#fff; line-height:40px; text-align:center; border-radius:50px; position:fixed; top:20%; left:40%; z-index:999999; font-weight:bold;",document.body.appendChild(c),setTimeout(function(){var a=.5;c.style.webkitTransition="-webkit-transform "+a+"s ease-in, opacity "+a+"s ease-in",c.style.opacity="0",setTimeout(function(){document.body.removeChild(c)},1e3*a)},b)}function w(){$("a.block-name").off("mouseenter mouseleave"),$("a.block-name").hover(function(){$(this).addClass("edit-hover")},function(){$(this).removeClass("edit-hover")}),$("a.block-name").off("click"),$("input.edit-category").each(function(){$(this).val($(this).prev().text().trim())}),$("a.block-name").on("click",function(){$(this).css("z-index","1"),$(this).css("cursor","default"),$(this).next().css("z-index","10"),$(this).next().css("visibility","visible"),$(this).next().focus(),$(this).next().select(),$(this).next().on("keydown",function(a){var c,b=a.which||a.keyCode;13==b&&(c=$(this).val(),$(this).css("z-index","1"),$(this).css("visibility","hidden"),$(this).prev().css("z-index","10"),category={id:$(this).prev().attr("id"),name:c},J(category))}),$(this).next().on("blur",function(){var a=$(this).val();$(this).css("z-index","1"),$(this).css("visibility","hidden"),$(this).prev().css("z-index","10"),category={id:$(this).prev().attr("id"),name:a},J(category)})})}function x(){$("a.block-name").css("z-index","10"),$("a.block-name").css("cursor","pointer"),$("a.block-name").off("mouseenter mouseleave"),$("a.block-name").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$("a.block-name").off("click"),$("a.block-name").on("click",function(){a=$(this).parents("div.building"),b=$(this).text(),$("#categoryConfirmModal").modal("show")}),$("input.edit-category").css("z-index","1"),$("input.edit-category").css("visibility","hidden")}function y(a){var b={};return b=h[parseInt(a)]}function z(a){var c,d,b={};b=h[parseInt(a)],c=b.name,d=b.url,$("input#website-name").val(c),$("input#website-url").val(d)}function A(a){var d,b={},c="";if(h=e[a],void 0!==h)for(d=0;d<h.length;d++)b=h[d],c+='<li class="website"><span class="website" id="'+d+'">'+b.name+"</span></li>";else c+="<p>不好意思，程序员的脑袋秀逗了：该分类下暂无站点，麻烦你选择其他分类吧</p>";$("div.website-grid ul.websites li").remove(),$("div.website-grid ul.websites").append(c)}function B(){$("div.website-grid li.website-category").on("click",function(){var a=$(this).find("span").text();$(this).siblings(".selected").removeClass("selected"),$(this).addClass("selected"),A(a),D()})}function C(){$("div#more-website-grid li.website-category").on("click",function(){var a=$(this).find("span").text();$(this).siblings(".selected").removeClass("selected"),$(this).addClass("selected"),A(a),E()})}function D(){$("div.website-grid li.website span.website").mouseenter(function(){var a=$(this).get(0);a.offsetWidth<a.scrollWidth&&$(this).attr("title",$(this).text()),$(this).addClass("hover"),websiteSerialIDInArray=$(this).attr("id"),website=y(websiteSerialIDInArray),website_url=website.url,htmlAsStr='<li class="preview"><img src="/static/img/preview.png"/><span> </span><a target="_blank" href="'+website_url+'">预览</a></li>',topOfPreview=$(this).parent().position().top-28,leftOfPreview=$(this).parent().position().left,$(this).parent().after(htmlAsStr),$("div.website-grid li.preview").css({top:topOfPreview,left:leftOfPreview}),$("div.website-grid li.preview").mouseleave(function(a){var b=a.relatedTarget||a.toElement;void 0!==$(b).attr("class")&&-1!=$(b).attr("class").indexOf("preview-related-element")||($(this).prev().children("span.website").removeClass("hover"),$(this).prev().removeClass("preview-related-element"),$(this).remove())})}).mouseleave(function(a){var b=a.relatedTarget||a.toElement;void 0!==$(b).attr("class")&&-1!=$(b).attr("class").indexOf("preview")?$(this).parent().addClass("preview-related-element"):($(this).removeClass("hover"),$(this).parent().siblings(".preview").remove())}),$("div.website-grid li.website span.website").on("click",function(){var a=$(this).attr("id");z(a)})}function E(){$("div#more-website-grid li.website span.website").hover(function(){var a=$(this).get(0);a.offsetWidth<a.scrollWidth&&$(this).attr("title",$(this).text()),$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$("div#more-website-grid li.website span.website").on("click",function(){var a=$(this).attr("id");F(a),$(this).removeClass("hover")})}function F(a){var c,b={};b=h[parseInt(a)],c=b.url,window.open(c,"_blank")}function G(){e={},f=[],$.getJSON("/static/websitetips.json",function(a){$.each(a,function(a,b){var d,c={};c.name=b.name,c.url=b.url,c.weight=b.weight,c.category=b.category,e[c.category]?(d=e[c.category],d.unshift(c)):(d=[],d.unshift(c),e[c.category]=d,f.unshift(c.category))});for(var b in e)e[b].sort(function(a,b){return a.weight-b.weight});f.sort(function(a,b){var c=["常用","社交","新闻","财经","科技","体育","数码","深度","商业","游戏","阅读","发现","二次元","娱乐","设计","IT技术","商旅","邮箱","工具","券商理财","求职兼职","房产","银行","生活","视频","音乐","游戏直播","购物","我在香港","我在台湾","我在日本","我在韩国","我在海外"],d=jQuery.inArray(a,c),e=jQuery.inArray(b,c);return d*e>0||0==d*e&&d+e>0?d-e:e-d})})}function H(a){var b,c,e,f;for(b in d)website_name=$("a."+hotkeyInClassName).children("span").text(),hotkeyInLowerCase=d[b].toLowerCase(),$("div#"+a+" span."+hotkeyInLowerCase).next().text(website_name);if(g.length>0){c=I(g);for(b in c)e=c[b],$("div#"+a+" span."+e.toLowerCase()).next().text("");f=$("input#website-hotkey").val().split(","),website_name=$("input#website-name").val();for(b in f)e=f[b],$("div#"+a+" span."+e.toLowerCase()).next().text(website_name)}}function I(a){var c,d,e,b=[];for(c in a)d=a[c].replace("hotkey",""),e=String.fromCharCode(parseInt(d)),32==parseInt(d)?b.unshift("SPACE"):b.unshift(e);return b=b.sort()}function J(a){$.ajax({type:"POST",url:"/replace/category",data:a,contentType:"application/x-www-form-urlencoded",success:function(b){"200"===b.code?K(a):s(b)}})}function K(a){category_in_document=$("a#"+a.id),category_in_document.text(a.name)}function M(a){console.log(a),website_id=a.id,website_in_document=$("#"+website_id),website_in_document.text(a.name),website_in_document.attr("href",a.url),website_in_document.removeClass(),website_in_document.addClass("website"),$("#editWebsiteModal").modal("hide")}function N(){cookie=$.cookie("login"),""===cookie||null==cookie||"null"===cookie?($("#login").text("登录"),$(".customize").css("display","none")):($("#login").text("退出"),$("#loginModal").attr("id","loginModal233"))}function O(a){var b,c,d;for(b in a)parseInt(b)>0&&parseInt(b)<10&&(c=JSON.parse(a.getItem(b)),$("a#"+b).text(c.category_name)),parseInt(b)>10&&parseInt(b)<100&&(d=JSON.parse(a.getItem(b)),$("a#"+b).children("span").text(d.website_name),$("a#"+b).attr("href",d.website_link),$("a#"+b).removeClass(),$("a#"+b).addClass("website"));$("div.blocks").css("opacity","1")}function R(){window.location.reload()}function S(){return(isIE=-1!=navigator.userAgent.toLowerCase().indexOf("msie"))?"ie":(isOpera=-1!=navigator.userAgent.toLowerCase().indexOf("metasr"))?"sougou":(isOpera=-1!=navigator.userAgent.toLowerCase().indexOf("lbbrowser"))?"liebao":(isOpera=-1!=navigator.userAgent.toLowerCase().indexOf("qihu 360ee"))?"360ee":(isFirefox=-1!=navigator.userAgent.toLowerCase().indexOf("firefox"))?"firefox":(isChrome=-1!=navigator.userAgent.toLowerCase().indexOf("chrome"))?"chrome":(isSafari=-1!=navigator.userAgent.toLowerCase().indexOf("safari"))?"safari":(isOpera=-1!=navigator.userAgent.toLowerCase().indexOf("opera"))?"opera":void 0}var a,b,c,d,e,f,g,h,i,P,Q;$("body").css("background-image","url(https://static.apkdv.com/hao/img/mountain.jpg)"),$("div.blocks").css("opacity","0"),$(window).resize(function(){$("div.content").css({position:"initial",top:15,margin:"0 auto","float":"none",display:"inherit"})}),$(window).resize(),$("a.website").attr("target","_blank"),$("a.website").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$("a.website").click(function(){$(this).removeClass("hover")}),$("a.block-name").click(function(){a=$(this).parents("div.building"),b=$(this).text().trim(),$("#categoryConfirmModal").modal("show")}),$("#categoryConfirmModal").on("show.bs.modal",function(){var c=$(this);c.find("#varText").text("打开 "+b+" 下所有站点？")}),$("#categoryConfirmButton").click(function(){a.find("a.website").each(function(){var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!0,!1,!1,!0,0,null),$(this).get(0).dispatchEvent(a)}),$("#categoryConfirmModal").modal("hide")}),$("a.chrome_extension").click(function(){$(this).parents("div.modal").modal("hide"),$("#extensionDownloadingModal").modal("show"),chrome.webstore.install("https://chrome.google.com/webstore/detail/aaaekojmfgkdoliidgddnefhnoibjbpi",R)}),c={},d=["SPACE","1","2","3","4","5","6","7","8","9","0","Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","C","V","B","N","M"],e={},f=[],g=[],h=[],i=!0,O(window.localStorage),k(),l(),m(),r(),N(),$(function(){var a={},b=!1;$("input#website-name").autocomplete({source:function(c,d){$.getJSON("/static/websitetips.json",function(e){var f=$.ui.autocomplete.escapeRegex(c.term),g=RegExp(f,"i");0==b?(a=e,b=!0,d($.grep(e,function(a){return g.test(a.name)||g.test(a.url)}))):d($.grep(a,function(a){return g.test(a.name)||g.test(a.url)}))})},appendTo:"#autocomplete-div",autoFocus:!0,select:function(a,b){return $("input#website-name").val(b.item.name),$("input#website-url").val(b.item.url),!1},open:function(){$("ul.ui-menu").width($(this).innerWidth()),$("#editWebsiteModal div.modal-header h3").next().html("小提示：鼠标点击输入框外任意位置即可关闭自动联想浮层")},close:function(){$("#editWebsiteModal div.modal-header h3").next().html("")}}).autocomplete("instance")._renderItem=function(a,b){return $("<li>").append("<a>"+b.name+"<br>"+b.url+"</a>").appendTo(a)}}),$(function(){$('[data-toggle="tooltip"]').tooltip()}),$("a.block-name").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$("a.customize").on("click",function(){u()?t():$("#notSupportLocalStorage").modal("show")}),$("a#finish-customize").on("click",function(){$("a.customize").css("display","inherit"),$("ul.navbar-right a").css("display","inherit"),$("a.website").css("z-index","10"),$("a.website").css("cursor","pointer"),$("a.website").off("click"),$("a.website").on("click",function(){$(this).removeClass("hover")}),$("span.edit-website").css("display","none"),$("span.edit-website").css("z-index","1"),$(this).css("display","none"),$("div#customize-mode-tips").css("display","none"),$("a.website").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),x()}),$("span.edit-website").hover(function(){$(this).addClass("hover"),$(this).prev().addClass("edit-hover")},function(){$(this).removeClass("hover"),$(this).prev().removeClass("edit-hover")}),$("span.edit-website").on("click",function(){j(),q(),$(this).prev().removeClass("edit-hover"),c.website_id=$(this).prev().attr("id"),c.website_name=$(this).prev().text(),c.website_link=$(this).prev().attr("href"),c.website_sibling_name=$(this).parents("div.building").find("a.website").text(),c.website_sibling_id=$(this).parents("div.building").find("a.website").attr("id"),$("input#website-id").val(c.website_id),$("input#website-name").val(c.website_name),$("input#website-url").val(c.website_link),A("常用"),B(),D(),$("#editWebsiteModal").modal("show")}),$("#editWebsiteModal").on("shown.bs.modal",function(){$("input#website-name").focus()}),$("#editWebsiteModal").on("hidden.bs.modal",function(){$("div.website-grid").css("display","none"),$("div#input-keyboard").css("display","none")}),$("button#update-website").on("click",function(){postData={id:$("input#website-id").val(),name:$("input#website-name").val(),url:$("input#website-url").val()},$.ajax({type:"POST",url:"/replace",data:postData,contentType:"application/x-www-form-urlencoded",success:function(a){"200"===a.code?M(postData):s(a)}})}),$("button#cancel-update").on("click",function(){$("#editWebsiteModal").modal("hide")}),$("input#website-name").on("focus",function(){$(this).select(),$("div.website-grid").css("display","inherit"),$("div#input-keyboard").css("display","none")}),$("input#website-url").on("focus",function(){$(this).select()}),$("div#input-keyboard li.key").hover(function(){$(this).addClass("hover"),$(this).css("cursor","pointer");var a=$(this).children("span.website-name").get(0);a.offsetWidth<a.scrollWidth&&$(this).attr("title",$(this).children("span.website-name").text())},function(){$(this).removeClass("hover"),$(this).css("cursor","default")}),$("div#input-keyboard li.key").on("click",function(){var a=$(this).children("span.letter").text(),b=$("input#website-name").val();$(this).children("span.website-name").text(b),$("input#website-hotkey").tagsinput("add",a)}),$("div.bootstrap-tagsinput input").on("focus",function(){H("input-keyboard"),o(),$("div#input-keyboard").css("display","inherit"),$("div.website-grid").css("display","none"),$(this).parents("div.bootstrap-tagsinput").css("border-color","#66afe9"),$(this).parents("div.bootstrap-tagsinput").css("box-shadow","0 0 8px #66afe9"),$(this).parents("div.bootstrap-tagsinput").css("-webkit-box-shadow","0 0 8px #66afe9"),$(this).parents("div.bootstrap-tagsinput").css("-moz-box-shadow","0 0 8px #66afe9")}),$("#login").on("click",function(){cookie=$.cookie("login"),""!==cookie&&null!=cookie&&"null"!==cookie&&($.cookie("login","",-1),window.location.reload())}),$("#login_btn").on("click",function(){postData={username:$("input#username").val(),password:$("input#password").val()},$.ajax({type:"POST",url:"login",data:postData,contentType:"application/x-www-form-urlencoded",success:function(a){"200"===a.code?(v("登录成功",2e3),window.location.reload()):s(a)}})}),$("div.bootstrap-tagsinput input").on("blur",function(){$(this).parents("div.bootstrap-tagsinput").css("border-color","#dcdddd"),$(this).parents("div.bootstrap-tagsinput").css("box-shadow",""),$(this).parents("div.bootstrap-tagsinput").css("-webkit-box-shadow",""),$(this).parents("div.bootstrap-tagsinput").css("-moz-box-shadow","")}),$("div#hotkey-modal-keyboard li.hotkey-modal-key").hover(function(){var a,b;$(this).addClass("hover"),$(this).css("cursor","pointer"),a="",a=""==$(this).children("span.website-name").text()?"该快捷键尚未设置，您可进入自定义模式设置":"按下该按键将打开 "+$(this).children("span.website-name").text(),$("#hotkeyModal div.modal-header h3").next().html(a),b=$(this).children("span.website-name").get(0),b.offsetWidth<b.scrollWidth&&$(this).attr("title",$(this).children("span.website-name").text())},function(){$(this).removeClass("hover"),$(this).css("cursor","default")}),$("#moreSitesModal").on("show.bs.modal",function(){$("div.website-grid").css("display","inherit"),q(),A("常用"),C(),E()}),$("#aboutModal div.about-modal-header ul.list-inline li").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}),$("div#aboutModal div.modal-header ul.list-inline li").on("click",function(){var a=$(this).attr("class").replace("selected","").replace("hover","").trim();$(this).siblings().removeClass("selected"),$(this).addClass("selected"),$("div#aboutModal div.modal-body div."+a).css("display","inherit"),$("div#aboutModal div.modal-body div."+a).siblings().css("display","none")}),$("div#customizeConfirmModal a.open_new_tab").on("click",function(){window.postMessage({type:"FROM_PAGE",text:"newtab"},"*")}),$("div#customizeConfirmModal a.skip").on("click",function(){$("#customizeConfirmModal").modal("hide"),t()}),P="index_tips_",Q=P+S(),$("div#"+Q).css("display","inherit")});